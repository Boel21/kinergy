$(document).ready(function () {
  let emailCheckValue;

  $("#searchText").on("keyup", function () {
    let email = $("#searchText").val();

    const regEmail =
      /^([0-9a-zA-Z_\.-]+)@([0-9a-zA-Z_-]+)(\.[0-9a-zA-Z_-]+){1,2}$/;

    if (regEmail.test(email)) {
      emailCheckValue = "Y";
    } else {
      emailCheckValue = "N";
    }
    characterCheck(emailCheckValue);
  });

  $("#c1").change(function () {
    characterCheck(emailCheckValue);
  });

  $(".pop_con")
    .find("#d_form_btn")
    .click(function () {
      let userEmail = $("#searchText").val();
      let siteCd = $("#siteCd").val();

      $.ajax({
        url: "/wsvc/api/newsletter-register.do",
        type: "POST",
        async: false,
        data: { email: userEmail, siteCd: siteCd },
        success: function () {
          alert("Your application has been completed.");
        },
        error: function (err) {
          alert("error");
        },
      });
      window.closePop(newsletter_pop);
      location.reload();
    });
});

function characterCheck(emailCheckValue) {
  const sendBtnCtrl = document.getElementById("d_form_btn");

  if (emailCheckValue == "Y" && $("#c1").is(":checked") == true) {
    sendBtnCtrl.classList.remove("disabled");
  } else {
    sendBtnCtrl.classList.add("disabled");
  }
}
